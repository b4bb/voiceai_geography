/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e,n,t={},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,o),a.exports}function a(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function c(t,r,o,a){var c=r&&r.prototype instanceof u?r:u,l=Object.create(c.prototype);return i(l,"_invoke",function(t,r,o){var a,i,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return a=n,i=0,c=e,f.n=t,s}};function p(t,r){for(i=t,c=r,n=0;!d&&u&&!o&&n<l.length;n++){var o,a=l[n],p=f.p,v=a[2];t>3?(o=v===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=t<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<v&&(o=t<3||a[0]>r||r>v)&&(a[4]=t,a[5]=r,f.n=v,i=0))}if(o||t>1)return s;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),i=l,c=v;(n=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,c)):f.n=c:f.v=c);try{if(u=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((n=(d=f.n<0)?c:t.call(r,f))!==s)break}catch(n){a=e,i=1,c=n}finally{u=1}}return{value:n,done:d}}}(t,o,a),!0),l}var s={};function u(){}function l(){}function d(){}n=Object.getPrototypeOf;var f=[][r]?n(n([][r]())):(i(n={},r,function(){return this}),n),p=d.prototype=u.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,i(p,"constructor",d),i(d,"constructor",l),l.displayName="GeneratorFunction",i(d,o,"GeneratorFunction"),i(p),i(p,o,"Generator"),i(p,r,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:c,m:v}})()}function i(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,n,t,r){function a(n,t){i(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},i(e,n,t,r)}function c(e,n,t,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function i(e){c(a,r,o,i,s,"next",e)}function s(e){c(a,r,o,i,s,"throw",e)}i(void 0)})}}o.m=t,o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce((n,t)=>(o.f[t](e,n),n),[])),o.u=e=>"static/"+e+".bundle.js",o.miniCssF=e=>{},o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),e={},n="elevenlabs-conversational-ai-demo:",o.l=(t,r,a,i)=>{if(e[t])e[t].push(r);else{var c,s;if(void 0!==a)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==t||d.getAttribute("data-webpack")==n+a){c=d;break}}c||(s=!0,(c=document.createElement("script")).charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.setAttribute("data-webpack",n+a),c.src=t),e[t]=[r];var f=(n,r)=>{c.onerror=c.onload=null,clearTimeout(p);var o=e[t];if(delete e[t],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach(e=>e(r)),n)return n(r)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=f.bind(null,c.onerror),c.onload=f.bind(null,c.onload),s&&document.head.appendChild(c)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="/",(()=>{var e={792:0};o.f.j=(n,t)=>{var r=o.o(e,n)?e[n]:void 0;if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((t,o)=>r=e[n]=[t,o]);t.push(r[2]=a);var i=o.p+o.u(n),c=new Error;o.l(i,t=>{if(o.o(e,n)&&(0!==(r=e[n])&&(e[n]=void 0),r)){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+n+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,r[1](c)}},"chunk-"+n,n)}};var n=(n,t)=>{var r,a,[i,c,s]=t,u=0;if(i.some(n=>0!==e[n])){for(r in c)o.o(c,r)&&(o.m[r]=c[r]);s&&s(o)}for(n&&n(t);u<i.length;u++)a=i[u],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0},t=self.webpackChunkelevenlabs_conversational_ai_demo=self.webpackChunkelevenlabs_conversational_ai_demo||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var u=null,l=null;function d(e){}function f(){return p.apply(this,arguments)}function p(){return(p=s(a().m(function e(){var n;return a().w(function(e){for(;;)switch(e.n){case 0:if(u){e.n=2;break}return e.n=1,o.e(209).then(o.bind(o,209));case 1:n=e.v,u=n.Conversation;case 2:return e.a(2,u)}},e)}))).apply(this,arguments)}var v=null,g=null;function m(e){document.getElementById("homePage").style.display="homePage"===e?"block":"none",document.getElementById("voiceAgentPage").style.display="voiceAgentPage"===e?"block":"none"}function y(e){return h.apply(this,arguments)}function h(){return(h=s(a().m(function e(n){var t,r,o,i;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("/api/validate-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:n})});case 1:if((t=e.v).ok){e.n=3;break}return e.n=2,t.json();case 2:throw r=e.v,new Error(r.detail||"Invalid invitation code");case 3:return e.n=4,t.json();case 4:return o=e.v,g=o,e.a(2,o);case 5:throw e.p=5,i=e.v,console.error("Error validating code:",i),i;case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=s(a().m(function e(n){var t,r,o;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("/api/increment-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:n})});case 1:if((t=e.v).ok){e.n=3;break}return e.n=2,t.json();case 2:throw r=e.v,new Error(r.detail||"Failed to increment code usage");case 3:return e.a(2,!0);case 4:throw e.p=4,o=e.v,console.error("Error incrementing code usage:",o),o;case 5:return e.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function E(){return k.apply(this,arguments)}function k(){return(k=s(a().m(function e(){var n,t,r,o,i;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(d(),n=document.getElementById("invitationCode"),t=document.getElementById("codeError"),r=document.getElementById("submitCode"),d(0),o=n.value.trim()){e.n=1;break}return d(),t.textContent="Please enter an invitation code",e.a(2);case 1:return e.p=1,d(),r.disabled=!0,d(0),e.n=2,y(o);case 2:d(),v=o,m("voiceAgentPage"),e.n=4;break;case 3:e.p=3,d(0,((i=e.v).message,i.stack)),t.textContent=i.message,n.value="";case 4:return e.p=4,d(),r.disabled=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}))).apply(this,arguments)}function S(){return C.apply(this,arguments)}function C(){return(C=s(a().m(function e(){var n;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,navigator.mediaDevices.getUserMedia({audio:!0});case 1:return e.a(2,!0);case 2:return e.p=2,n=e.v,console.error("Microphone permission denied:",n),e.a(2,!1)}},e,null,[[0,2]])}))).apply(this,arguments)}function P(){return j.apply(this,arguments)}function j(){return(j=s(a().m(function e(){var n,t,r;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Fetching signed URL..."),e.n=1,fetch("/api/signed-url");case 1:return n=e.v,console.log("Signed URL Response:",{status:n.status,statusText:n.statusText,headers:Object.fromEntries(n.headers.entries())}),e.n=2,n.json();case 2:if(t=e.v,console.log("Signed URL Data:",t),n.ok){e.n=3;break}throw new Error("Failed to get signed URL: ".concat(n.status," ").concat(n.statusText));case 3:return e.a(2,t.signedUrl);case 4:throw e.p=4,r=e.v,console.error("Error getting signed URL:",r),r;case 5:return e.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function B(e){var n=document.getElementById("connectionStatus");n.textContent=e?"Connected":"Disconnected",n.classList.toggle("connected",e)}function O(e){var n=document.getElementById("speakingStatus"),t="speaking"===e.mode;n.textContent=t?"Agent Speaking":"Agent Silent",n.classList.toggle("speaking",t),console.log("Speaking status updated:",{mode:e,isSpeaking:t})}function T(){return(T=s(a().m(function e(){var n,t,r,o,i,c,s;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(v){e.n=1;break}return alert("Invalid session. Please enter your invitation code again."),m("homePage"),e.a(2);case 1:return n=document.getElementById("startButton"),t=document.getElementById("endButton"),e.p=2,e.n=3,y(v);case 3:return e.n=4,b(v);case 4:return e.n=5,S();case 5:if(e.v){e.n=6;break}return alert("Microphone permission is required for the conversation."),e.a(2);case 6:return e.n=7,P();case 7:return o=e.v,e.n=8,f();case 8:return i=e.v,c=null!==(r=g)&&void 0!==r&&r.first_name&&g.first_name.trim()?g.first_name.trim():"Charlie",console.log("ðŸ”¥ðŸ”¥ðŸ”¥ CUSTOMER NAME DEBUG:",c,"ðŸ”¥ðŸ”¥ðŸ”¥"),e.n=9,i.startSession({signedUrl:o,dynamicVariables:{customer_name:c},onConnect:function(){console.log("WebSocket Connected"),B(!0),n.disabled=!0,t.disabled=!1},onDisconnect:function(){console.log("Disconnected"),B(!1),n.disabled=!1,t.disabled=!0,O({mode:"listening"})},onError:function(e){console.error("Conversation error:",e),alert("An error occurred during the conversation.")},onModeChange:function(e){console.log("Mode Changed:",e),O(e)},onMessage:function(e){console.log("Agent Response:",e)}});case 9:l=e.v,e.n=11;break;case 10:e.p=10,s=e.v,console.error("Failed to start conversation:",s),s.message.includes("Invalid invitation code")||s.message.includes("expired")||s.message.includes("Maximum number")?(alert(s.message),m("homePage"),v=null,g=null):alert("Failed to start conversation. Please try again.");case 11:return e.a(2)}},e,null,[[2,10]])}))).apply(this,arguments)}function I(){return(I=s(a().m(function e(){var n,t,r;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=document.getElementById("endButton"),t=document.getElementById("startButton"),!l){e.n=5;break}return e.p=1,n.disabled=!0,e.n=2,l.endSession();case 2:B(!1),O({mode:"listening"}),t.disabled=!1,l=null,e.n=4;break;case 3:e.p=3,r=e.v,console.error("Error ending conversation:",r);case 4:return e.p=4,n.disabled=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}))).apply(this,arguments)}function _(){var e=document.getElementById("submitCode"),n=document.getElementById("invitationCode");e&&n&&(["click","touchend"].forEach(function(n){e.addEventListener(n,function(e){"Submit button ".concat(n," event triggered"),e.type,e.target.id,(new Date).getTime(),e.preventDefault(),E()})}),n.addEventListener("keypress",function(e){e.key,e.target.id,"Enter"===e.key&&(e.preventDefault(),E())}),e.disabled,window.getComputedStyle(e).display,window.getComputedStyle(e).visibility,window.getComputedStyle(e).pointerEvents,navigator.userAgent)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",_):_(),document.getElementById("startButton").addEventListener("click",function(){return T.apply(this,arguments)}),document.getElementById("endButton").addEventListener("click",function(){return I.apply(this,arguments)}),window.addEventListener("error",function(e){console.error("Global error:",e.error)})})();